(this["webpackJsonprandom-dungeon"]=this["webpackJsonprandom-dungeon"]||[]).push([[0],{14:function(e,t,n){e.exports=n(23)},20:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);var r,i=n(0),a=n(13),o=n(1),s=n.n(o),l=n(9),c=n(2),u=n(5);n(20);function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.Render,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,i=0,a=0,o=!1,s=!1,l=!1,c=!1,u=!1,f=!1,h=!1;switch(e){case r.CreateTiles:l=!0;break;case r.CreateNodes:i=1,l=!0;break;case r.AssociateTiles:i=1,a=.66,l=!0;break;case r.LinkNodes:i=1,a=.5,o=!0,l=!0;break;case r.FilterLinks:i=.75,a=.55,s=!0,l=!0;break;case r.ExpandLines:case r.CreateRooms:a=.5,l=!0;break;case r.DetectWalls:l=!0;break;case r.CurveWalls:l=!0,c=!0,u=!t;break;case r.FillBackdrop:l=!0,c=!0,h=!0;break;case r.Render:l=!0,c=!0,f=!0}return{nodeAlpha:i,regionAlpha:a,drawGraph:o,drawNodeLinks:s,drawGrid:l,drawWalls:c,highlightWallCurves:u,drawOutsidePoints:h,drawOutside:f,floorColor:"#fff",floorGridColor:"rgba(192,192,192,0.5)",backgroundColor:"#fff",hatchingColor:"#000",wallColor:"#000",cellSize:n,wallWidth:n,floorGridWidth:1,hatchingWidth:.175*n,drawWallsAsFloor:!0}}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}!function(e){e[e.CreateTiles=0]="CreateTiles",e[e.CreateNodes=1]="CreateNodes",e[e.AssociateTiles=2]="AssociateTiles",e[e.LinkNodes=3]="LinkNodes",e[e.FilterLinks=4]="FilterLinks",e[e.ExpandLines=5]="ExpandLines",e[e.CreateRooms=6]="CreateRooms",e[e.DetectWalls=7]="DetectWalls",e[e.CurveWalls=8]="CurveWalls",e[e.FillBackdrop=9]="FillBackdrop",e[e.Render=10]="Render",e[e.FIRST_STEP=0]="FIRST_STEP"}(r||(r={}));var d=function(e){var t=e.generate,n=e.regenerate,a=Object(i.useMemo)((function(){return function(){return t(r.Render)}}),[t]),o=Object(i.useMemo)((function(){return function(){return n(!0,r.AssociateTiles,r.Render)}}),[n]),s=e.isGenerating?i.createElement("button",{className:"menu__button"},"Skip step"):i.createElement("button",{className:"menu__button",onClick:a},"Generate new"),c=e.isGenerating?i.createElement("button",{className:"menu__button"},"Finish"):i.createElement("button",{className:"menu__button",onClick:o},"Animate generation");return Object(i.useEffect)((function(){e.setRenderSettings(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},f(r.Render,!0,e.cellSize)))}),[]),i.createElement("div",{className:"menu menu--autoGenerate"},i.createElement("button",{className:"menu__link",onClick:e.showSize},"Map size"),i.createElement("button",{className:"menu__link",onClick:e.showRegions},"Edit regions"),i.createElement("button",{className:"menu__link",onClick:e.showConnections},"Regions connections"),i.createElement("button",{className:"menu__link",onClick:e.showRenders},"Renders"),i.createElement("div",{className:"menu__spacer"}),s,c)},v=function(e){var t=e.onChange,n=e.onChangeComplete,r=Object(i.useMemo)((function(){if(void 0!==t)return function(e){return t(e.target.valueAsNumber)}}),[t]),a=Object(i.useMemo)((function(){if(void 0!==n)return function(){return n()}}),[n]);return i.createElement("label",{className:e.className},e.label,i.createElement("input",{type:"range",className:e.inputClassName,min:e.min,max:e.max,value:e.value,onChange:r,onMouseUp:a,onTouchEnd:a,disabled:e.disabled}))};function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b,g=function(e){return Object(i.useEffect)((function(){e.setRenderSettings(p({},f(r.DetectWalls,!0,e.cellSize),{drawWallsAsFloor:!1}))}),[]),i.createElement("div",{className:"menu menu--mapSize"},i.createElement("button",{className:"menu__button menu__button--back",onClick:e.goBack},"Go back"),i.createElement("div",{className:"menu__group"},i.createElement(v,{label:"Width",min:20,max:200,value:e.generationSettings.cellsWide,onChange:function(t){e.setGenerationSettings(p({},e.generationSettings,{cellsWide:t}))},onChangeComplete:e.redraw}),i.createElement(v,{label:"Height",min:20,max:200,value:e.generationSettings.cellsHigh,onChange:function(t){e.setGenerationSettings(p({},e.generationSettings,{cellsHigh:t}))},onChangeComplete:e.redraw})))},m=n(3),x=n(4),k=n(6),w=n(7),S=n(8),O=function(e){function t(e,n){var r;return Object(m.a)(this,t),(r=Object(x.a)(this,Object(k.a)(t).call(this))).x=e,r.y=n,r}return Object(w.a)(t,e),Object(S.a)(t,[{key:"length",value:function(){return this.magnitude(this.x,this.y)}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"subtract",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"toUnitLength",value:function(){var e=this.length();return new t(this.x/e,this.y/e)}},{key:"distanceTo",value:function(e){return this.magnitude(this.x-e.x,this.y-e.y)}},{key:"distanceSqTo",value:function(e){return this.magnitudeSq(this.x-e.x,this.y-e.y)}},{key:"directionTo",value:function(e){var n=e.x-this.x,r=e.y-this.y,i=this.magnitude(n,r);return new t(n/i,r/i)}},{key:"halfwayTo",value:function(e){return new t((this.x+e.x)/2,(this.y+e.y)/2)}},{key:"scale",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return new t(this.x*e,this.y*e)}))},{key:"crossProduct",value:function(e){return this.x*e.y-this.y*e.x}},{key:"circumCircle",value:function(e,n){var r=this,i=(r.x-n.x)*(e.y-n.y)-(e.x-n.x)*(r.y-n.y),a=new t((((r.x-n.x)*(r.x+n.x)+(r.y-n.y)*(r.y+n.y))/2*(e.y-n.y)-((e.x-n.x)*(e.x+n.x)+(e.y-n.y)*(e.y+n.y))/2*(r.y-n.y))/i,(((e.x-n.x)*(e.x+n.x)+(e.y-n.y)*(e.y+n.y))/2*(r.x-n.x)-((r.x-n.x)*(r.x+n.x)+(r.y-n.y)*(r.y+n.y))/2*(e.x-n.x))/i);return[a,(n.x-a.x)*(n.x-a.x)+(n.y-a.y)*(n.y-a.y)]}},{key:"magnitude",value:function(e,t){return Math.sqrt(this.magnitudeSq(e,t))}},{key:"magnitudeSq",value:function(e,t){return e*e+t*t}}]),t}((function e(){Object(m.a)(this,e)}));!function(e){e[e.Natural=0]="Natural",e[e.Artificial=1]="Artificial",e[e.NUM_VALUES=2]="NUM_VALUES",e[e.FIRST_VALUE=0]="FIRST_VALUE"}(b||(b={}));var j,P=function(e){function t(e,n,r,i,a,o){var s,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Object(m.a)(this,t),(s=Object(x.a)(this,Object(k.a)(t).call(this,n,r))).parent=e,s.seed=i,s.regionType=a,s.color=o,s.regionInfluence=l,s.radius=.75,s.links=[],s}return Object(w.a)(t,e),t}(O),C=["7","8","9","a","b","c","d"];function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}!function(e){e[e.AddRemove=0]="AddRemove",e[e.Resize=1]="Resize",e[e.ChangeType=2]="ChangeType"}(j||(j={}));var T,z=function(e){var t=e.dungeonDisplay,n=e.dungeon,a=e.redraw,o=e.cellSize;Object(i.useEffect)((function(){e.setRenderSettings(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},f(r.DetectWalls,!0,e.cellSize),{regionAlpha:.5,nodeAlpha:1,drawWallsAsFloor:!1}))}),[]);var s,c=Object(i.useState)(j.AddRemove),h=Object(u.a)(c,2),d=h[0],v=h[1];switch(Object(i.useEffect)((function(){if(void 0!==t){var e,r;switch(d){case j.AddRemove:e=function(e){var t=e.offsetX/o,r=e.offsetY/o,i=Math.random(),s=Math.floor(Math.random()*b.NUM_VALUES);n.nodes.push(new P(n,t,r,i,s,function(){var e=C[Math.floor(Math.random()*C.length)],t=C[Math.floor(Math.random()*C.length)],n=C[Math.floor(Math.random()*C.length)];return"#".concat(e).concat(t).concat(n)}())),a()},r=function(e){var t=e.offsetX/o,r=e.offsetY/o;e.preventDefault();var i=n.getTileAt(t,r);if(void 0!==i&&null!==i.region){var s=i.region;n.nodes=n.nodes.filter((function(e){return e!==s})),a()}};break;case j.Resize:e=function(e){var t=e.offsetX/o,r=e.offsetY/o,i=n.getTileAt(t,r);void 0!==i&&null!==i.region&&(i.region.regionInfluence*=1.2,a())},r=function(e){var t=e.offsetX/o,r=e.offsetY/o;e.preventDefault();var i=n.getTileAt(t,r);void 0!==i&&null!==i.region&&(i.region.regionInfluence/=1.2,a())};break;case j.ChangeType:e=function(e){var t=e.offsetX/o,r=e.offsetY/o,i=n.getTileAt(t,r);void 0!==i&&null!==i.region&&(++i.region.regionType>=b.NUM_VALUES&&(i.region.regionType=b.FIRST_VALUE),a())},r=function(e){var t=e.offsetX/o,r=e.offsetY/o;e.preventDefault();var i=n.getTileAt(t,r);void 0!==i&&null!==i.region&&(i.region.seed=Math.random(),a())};break;default:return}return t.addEventListener("click",e),t.addEventListener("contextmenu",r),function(){t.removeEventListener("click",e),t.removeEventListener("contextmenu",r)}}}),[t,n,a,o,d]),d){case j.AddRemove:s="Left click the map to place region nodes. Right click to remove a region.";break;case j.Resize:s="Left click the a region to grow it, right click a region to shrink it.";break;case j.ChangeType:s="Left click a region to change its type. Right click to regenerate it with the same type."}return i.createElement("div",{className:"menu menu--regionPlacement"},i.createElement("button",{className:"menu__button menu__button--back",onClick:e.goBack},"Go back"),i.createElement("ul",{className:"menu__choice"},i.createElement("li",{className:d===j.AddRemove?"menu__selector menu__selector--active":"menu__selector",onClick:function(){return v(j.AddRemove)}},"Add/remove regions"),i.createElement("li",{className:d===j.Resize?"menu__selector menu__selector--active":"menu__selector",onClick:function(){return v(j.Resize)}},"Resize regions"),i.createElement("li",{className:d===j.ChangeType?"menu__selector menu__selector--active":"menu__selector",onClick:function(){return v(j.ChangeType)}},"Change region types")),i.createElement("div",{className:"menu__section"},s))};!function(e){e[e.Main=0]="Main",e[e.Size=1]="Size",e[e.Regions=2]="Regions",e[e.Connections=3]="Connections",e[e.Renders=4]="Renders"}(T||(T={}));var M=function(e){var t=Object(i.useState)(T.Main),n=Object(u.a)(t,2),a=n[0],o=n[1],s=Object(i.useMemo)((function(){return function(){return o(T.Main)}}),[]),l=Object(i.useMemo)((function(){return function(){return o(T.Size)}}),[]),c=Object(i.useMemo)((function(){return function(){return o(T.Regions)}}),[]),f=Object(i.useMemo)((function(){return function(){return o(T.Connections)}}),[]),h=Object(i.useMemo)((function(){return function(){return o(T.Renders)}}),[]);switch(a){case T.Size:return i.createElement(g,{goBack:s,generationSettings:e.generationSettings,setGenerationSettings:e.setGenerationSettings,cellSize:e.cellSize,setRenderSettings:e.setRenderSettings,redraw:function(){return e.regenerate(!1,r.AssociateTiles,r.CreateRooms)}});case T.Regions:return i.createElement(z,{goBack:s,dungeon:e.dungeon,dungeonDisplay:e.canvas,cellSize:e.cellSize,setRenderSettings:e.setRenderSettings,redraw:function(){return e.regenerate(!1,r.AssociateTiles,r.Render)}});default:return i.createElement(d,{isGenerating:e.isGenerating,setRenderSettings:e.setRenderSettings,cellSize:e.cellSize,generate:e.generate,regenerate:e.regenerate,skip:e.skip,finish:e.finish,showSize:l,showRegions:c,showConnections:f,showRenders:h})}},L=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(x.a)(this,Object(k.a)(t).call(this,e))).ctx=void 0,n.root=void 0,n.canvas=void 0,n.state={width:void 0===e.width?0:e.width,height:void 0===e.height?0:e.height},n}return Object(w.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this;return i.createElement("div",{className:this.props.className,ref:function(t){return e.root=null===t?e.root:t}},i.createElement("canvas",{width:this.props.width,height:this.props.height,ref:function(t){return e.canvas=null===t?e.canvas:t}}))}},{key:"componentDidMount",value:function(){this.updateCtx()}},{key:"componentDidUpdate",value:function(e,t){this.updateCtx()}},{key:"updateCtx",value:function(){if(void 0!==this.canvas){var e=this.canvas.getContext("2d");null!==e&&(this.ctx=e)}}}]),t}(i.Component),E=(i.Component,function(){function e(){Object(m.a)(this,e),this.nodes=[],this.lines=[],this.backdropPoints=[],this.delauneyLines=[],this.gabrielLines=[],this.relativeNeighbourhoodLines=[],this.minimumSpanningLines=[],this.width=0,this.height=0,this.tiles=[],this.tilesByCoordinates=[],this.walls=[]}return Object(S.a)(e,[{key:"getTileAt",value:function(e,t){var n=this.tilesByCoordinates[Math.floor(e)];if(void 0!==n)return n[Math.floor(t)]}}]),e}());n(21);function A(e,t,n){if(t.clearRect(0,0,e.width*n.cellSize,e.height*n.cellSize),n.drawGrid&&function(e,t,n){e.lineWidth=n.floorGridWidth;var r=!0,i=!1,a=void 0;try{for(var o,s=t.tiles[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){N(o.value,e,n)}}catch(l){i=!0,a=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}(t,e,n),n.drawGraph&&function(e,t,n){e.globalAlpha=.25,e.strokeStyle="#000",e.lineWidth=n.cellSize;var r=!0,i=!1,a=void 0;try{for(var o,s=t.minimumSpanningLines[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){_(o.value,e,n)}}catch(S){i=!0,a=S}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}e.lineWidth=.5*n.cellSize;var l=!0,c=!1,u=void 0;try{for(var f,h=t.relativeNeighbourhoodLines[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){_(f.value,e,n)}}catch(S){c=!0,u=S}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}e.lineWidth=.25*n.cellSize;var d=!0,v=!1,y=void 0;try{for(var p,b=t.gabrielLines[Symbol.iterator]();!(d=(p=b.next()).done);d=!0){_(p.value,e,n)}}catch(S){v=!0,y=S}finally{try{d||null==b.return||b.return()}finally{if(v)throw y}}e.lineWidth=1;var g=!0,m=!1,x=void 0;try{for(var k,w=t.delauneyLines[Symbol.iterator]();!(g=(k=w.next()).done);g=!0){_(k.value,e,n)}}catch(S){m=!0,x=S}finally{try{g||null==w.return||w.return()}finally{if(m)throw x}}e.globalAlpha=1}(t,e,n),n.drawOutside&&function(e,t,n){e.fillStyle=n.backgroundColor,e.save(),I(e,t,n),e.fillRect(0,0,t.width*n.cellSize,t.height*n.cellSize),e.strokeStyle=n.hatchingColor,e.lineWidth=n.hatchingWidth;var r=.6*n.cellSize,i=!0,a=!1,o=void 0;try{for(var s,l=t.backdropPoints[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value,u=n.cellSize*c.lengthScale;e.save(),e.translate(c.x*n.cellSize,c.y*n.cellSize),e.rotate(c.rotation),e.beginPath(),e.moveTo(-r,-u-c.topSkew*n.cellSize),e.lineTo(r,-u+c.topSkew*n.cellSize),e.lineTo(r,u-c.bottomSkew*n.cellSize),e.lineTo(-r,u+c.bottomSkew*n.cellSize),e.fill(),e.beginPath(),e.moveTo(-r,-u-c.topSkew*n.cellSize),e.lineTo(-r,u+c.bottomSkew*n.cellSize),e.moveTo(0,-u),e.lineTo(0,u),e.moveTo(r,-u+c.topSkew*n.cellSize),e.lineTo(r,u-c.bottomSkew*n.cellSize),e.stroke(),e.restore()}}catch(f){a=!0,o=f}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}e.restore()}(t,e,n),n.drawOutsidePoints&&function(e,t,n){e.save(),I(e,t,n),e.globalAlpha=.75,e.fillStyle="#009";var r=!0,i=!1,a=void 0;try{for(var o,s=t.backdropPoints[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;e.beginPath(),e.arc(l.x*n.cellSize,l.y*n.cellSize,.25*n.cellSize,0,2*Math.PI),e.fill()}}catch(c){i=!0,a=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}e.restore()}(t,e,n),n.drawWalls){t.strokeStyle=t.fillStyle=n.highlightWallCurves?"#f00":"#000",t.lineCap="round";var r=!0,i=!1,a=void 0;try{for(var o,s=e.walls[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){W(o.value,t,n)}}catch(v){i=!0,a=v}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}t.lineCap="butt"}if(n.drawNodeLinks){t.lineWidth=1,t.strokeStyle="#000";var l=!0,c=!1,u=void 0;try{for(var f,h=e.lines[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){_(f.value,t,n)}}catch(v){c=!0,u=v}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}}if(n.nodeAlpha>0){t.globalAlpha=n.nodeAlpha;for(var d=0;d<e.nodes.length;d++)F(e.nodes[d],t,n);t.globalAlpha=1}}function _(e,t,n){t.beginPath(),t.moveTo(e.from.x*n.cellSize,e.from.y*n.cellSize),t.lineTo(e.to.x*n.cellSize,e.to.y*n.cellSize),t.stroke()}function F(e,t,n){t.fillStyle="#c00",t.beginPath(),t.arc(e.x*n.cellSize,e.y*n.cellSize,n.cellSize*e.radius,0,2*Math.PI),t.fill()}function N(e,t,n){!e.isFloor||e.isWall&&!n.drawWallsAsFloor?e.isWall&&(t.fillStyle="#333",t.fillRect(e.x*n.cellSize,e.y*n.cellSize,n.cellSize,n.cellSize)):(t.fillStyle=n.floorColor,t.fillRect(e.x*n.cellSize,e.y*n.cellSize,n.cellSize,n.cellSize),t.strokeStyle=n.floorGridColor,t.strokeRect(e.x*n.cellSize,e.y*n.cellSize,n.cellSize,n.cellSize)),n.regionAlpha>0&&null!==e.region&&(t.globalAlpha=n.regionAlpha,t.fillStyle=e.region.color,t.fillRect(e.x*n.cellSize,e.y*n.cellSize,n.cellSize,n.cellSize),t.globalAlpha=1)}function W(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=n.cellSize/2;if(1!==e.keyPoints.length){var a=e.renderPoints,o=a[0]*n.cellSize+i,s=a[1]*n.cellSize+i;r&&t.beginPath(),t.moveTo(o,s),t.lineWidth=n.wallWidth;for(var l=0;l<a.length;l+=2)o=a[l]*n.cellSize+i,s=a[l+1]*n.cellSize+i,t.lineTo(o,s);r&&t.stroke()}else if(r){var c=e.keyPoints[0],u=c.x*n.cellSize+i,f=c.y*n.cellSize+i;t.beginPath(),t.arc(u,f,n.wallWidth/2,0,2*Math.PI),t.fill()}}function I(e,t,n){e.beginPath(),e.rect(0,0,t.width*n.cellSize,t.height*n.cellSize);var r=!0,i=!1,a=void 0;try{for(var o,s=t.walls[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){W(o.value,e,n,!1)}}catch(l){i=!0,a=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}e.clip("evenodd")}var B=function(){function e(t){Object(m.a)(this,e),this.seed=t,this.c=void 0,this.s0=void 0,this.s1=void 0,this.s2=void 0;var n=this.mash();this.c=1,this.s0=n(" "),this.s1=n(" "),this.s2=n(" "),this.s0-=n(t),this.s0<0&&(this.s0+=1),this.s1-=n(t),this.s1<0&&(this.s1+=1),this.s2-=n(t),this.s2<0&&(this.s2+=1)}return Object(S.a)(e,[{key:"next",value:function(){var e=2091639*this.s0+2.3283064365386963e-10*this.c;return this.s0=this.s1,this.s1=this.s2,this.s2=e-(this.c=0|e)}},{key:"nextInt32",value:function(){return 4294967296*this.next()|0}},{key:"nextInRange",value:function(e,t){return e+this.next()*(t-e)}},{key:"nextIntInRange",value:function(e,t){return Math.floor(this.nextInRange(e,t))}},{key:"nextColor",value:function(){var e=["7","8","9","a","b","c","d"],t=e[this.nextIntInRange(0,e.length)],n=e[this.nextIntInRange(0,e.length)],r=e[this.nextIntInRange(0,e.length)];return"#".concat(t).concat(n).concat(r)}},{key:"mash",value:function(){var e=4022871197,t=function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}}]),e}();function D(e,t,n,r){return G.apply(this,arguments)}function G(){return(G=Object(c.a)(s.a.mark((function e(t,n,r,i){var a,o,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new B(r),o=function(){var e=a.nextInRange(3,t.width-4),n=a.nextInRange(3,t.height-4),r=a.nextInRange(.6,1.8),i=a.nextIntInRange(0,b.NUM_VALUES),o=a.next(),s=a.nextColor();return new P(t,e,n,o,i,s,r)},t.nodes=[],l=0;case 4:if(!(l<n.nodeCount)){e.next=12;break}if(q(t,o,t.width,t.height),!i){e.next=9;break}return e.next=9,i(Be.Small);case 9:l++,e.next=4;break;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t,n,r){var i=function(e,t,n,r){var i=(e.x-t.x)/n,a=(e.y-t.y)/r;return i*i+a*a},a=t(),o=t(),s=Number.MAX_VALUE,l=Number.MAX_VALUE,c=!0,u=!1,f=void 0;try{for(var h,d=e.nodes[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var v=h.value;s=Math.min(s,i(a,v,n,r)),l=Math.min(l,i(o,v,n,r))}}catch(y){u=!0,f=y}finally{try{c||null==d.return||d.return()}finally{if(u)throw f}}e.nodes.push(s<l?o:a)}var U=function(e){function t(e){var n;Object(m.a)(this,t),(n=Object(x.a)(this,Object(k.a)(t).call(this,e))).circumCenter=void 0,n.circumRadiusSq=void 0;var r=e[0].circumCircle(e[1],e[2]);return n.circumCenter=r[0],n.circumRadiusSq=r[1],n}return Object(w.a)(t,e),t}((function e(t){Object(m.a)(this,e),this.vertices=t}));function X(e,t){if(e.length<3)return[];var n=[];n.push(new U(t));var r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value,c=[],u=!0,f=!1,h=void 0;try{for(var d,v=n[Symbol.iterator]();!(u=(d=v.next()).done);u=!0){var y=d.value;V(l,y)&&c.push(y)}}catch(q){f=!0,h=q}finally{try{u||null==v.return||v.return()}finally{if(f)throw h}}for(var p=[],b=0,g=c;b<g.length;b++)for(var m=g[b],x=0;x<3;x++){var k=m.vertices[x],w=m.vertices[2===x?0:x+1],S=!1,O=!0,j=!1,P=void 0;try{for(var C,R=c[Symbol.iterator]();!(O=(C=R.next()).done);O=!0){var T=C.value;if(T!==m&&(-1!==T.vertices.indexOf(k)&&-1!==T.vertices.indexOf(w))){S=!0;break}}}catch(q){j=!0,P=q}finally{try{O||null==R.return||R.return()}finally{if(j)throw P}}S||p.push(k,w)}for(var z=0,M=c;z<M.length;z++){var L=M[z];n.splice(n.indexOf(L),1)}for(var E=0;E<p.length-1;E+=2){var A=new U([p[E],p[E+1],l]);n.push(A)}}}catch(q){i=!0,a=q}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}for(var _=0;_<n.length;_++){var F=n[_],N=!0,W=!1,I=void 0;try{for(var B,D=F.vertices[Symbol.iterator]();!(N=(B=D.next()).done);N=!0){var G=B.value;if(-1!==t.indexOf(G)){n.splice(_,1),_--;break}}}catch(q){W=!0,I=q}finally{try{N||null==D.return||D.return()}finally{if(W)throw I}}}return n}function V(e,t){return e.distanceSqTo(t.circumCenter)<=t.circumRadiusSq}function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.lines,n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value,c=!1,u=l.from.halfwayTo(l.to),f=l.from.distanceSqTo(u),h=!0,d=!1,v=void 0;try{for(var y,p=e.nodes[Symbol.iterator]();!(h=(y=p.next()).done);h=!0){var b=y.value;if(b!==l.from&&b!==l.to&&b.distanceSqTo(u)<f){c=!0;break}}}catch(g){d=!0,v=g}finally{try{h||null==p.return||p.return()}finally{if(d)throw v}}c||n.push(l)}}catch(g){i=!0,a=g}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}function H(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)for(var l=o.value,c=function(e){var r=l.vertices[0===e?l.vertices.length-1:e-1],i=l.vertices[e];n.some((function(e){return e.from===r&&e.to===i||e.from===i&&e.to===r}))||n.push(t(r,i))},u=0;u<l.vertices.length;u++)c(u)}catch(f){i=!0,a=f}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}function J(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.lines,n=e.nodes.slice(),r=n.pop();if(void 0===r)return[];var i=t.map((function(e){return{link:e,lengthSq:e.from.distanceSqTo(e.to)}}));i.sort((function(e,t){return e.lengthSq-t.lengthSq}));for(var a=[r],o=[];n.length>0&&i.length>0;)for(var s=0;s<i.length;s++){var l=i[s].link,c=-1!==a.indexOf(l.from),u=-1!==a.indexOf(l.to);if(c||u){i.splice(s,1),o.push(l);for(var f=c?l.to:l.from,h=s;h<i.length;h++)((l=i[h].link).from===f&&-1!==a.indexOf(l.to)||l.to===f&&-1!==a.indexOf(l.from))&&(i.splice(h,1),h--);a.push(f);break}}return o}function $(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.lines,n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value,c=!1,u=l.from.distanceSqTo(l.to),f=!0,h=!1,d=void 0;try{for(var v,y=e.nodes[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var p=v.value;if(p!==l.from&&p!==l.to&&(p.distanceSqTo(l.from)<u&&p.distanceSqTo(l.to)<u)){c=!0;break}}}catch(b){h=!0,d=b}finally{try{f||null==y.return||y.return()}finally{if(h)throw d}}c||n.push(l)}}catch(b){i=!0,a=b}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}var K=n(11),Q=function(e){function t(e,n){var r;return Object(m.a)(this,t),r=Object(x.a)(this,Object(k.a)(t).call(this,e,n)),e.links.push(Object(K.a)(r)),n.links.push(Object(K.a)(r)),r}return Object(w.a)(t,e),t}((function e(t,n){Object(m.a)(this,e),this.from=t,this.to=n}));function Z(e,t,n,r){return ee.apply(this,arguments)}function ee(){return(ee=Object(c.a)(s.a.mark((function e(t,n,r,i){var a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.lines=[],t.delauneyLines=[],t.gabrielLines=[],t.relativeNeighbourhoodLines=[],t.minimumSpanningLines=[],a=[new P(t,0,0,0,b.Artificial,""),new P(t,999999,0,0,b.Artificial,""),new P(t,0,999999,0,b.Artificial,"")],o=X(t.nodes,a),t.delauneyLines=H(o,(function(e,t){return new Q(e,t)})),!i){e.next=11;break}return e.next=11,i(Be.Medium);case 11:if(t.gabrielLines=Y(t,t.delauneyLines),!i){e.next=15;break}return e.next=15,i(Be.Medium);case 15:if(t.relativeNeighbourhoodLines=$(t,t.gabrielLines),!i){e.next=19;break}return e.next=19,i(Be.Medium);case 19:t.minimumSpanningLines=J(t,t.relativeNeighbourhoodLines);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t,n,r){return ne.apply(this,arguments)}function ne(){return(ne=Object(c.a)(s.a.mark((function e(t,n,r,i){var a,o,l,c,u,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n.connectivity<50?(t.lines=t.minimumSpanningLines.slice(),a=t.relativeNeighbourhoodLines.filter((function(e){return-1===t.lines.indexOf(e)})),o=n.connectivity/50):(t.lines=t.relativeNeighbourhoodLines.slice(),a=t.gabrielLines.filter((function(e){return-1===t.lines.indexOf(e)})),o=(n.connectivity-50)/50),l=new B(r),c=Math.round(a.length*o),u=c;u>0;u--)f=a.splice(l.nextIntInRange(0,a.length),1)[0],t.lines.push(f);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re=n(10);function ie(e,t,n){return ae.apply(this,arguments)}function ae(){return(ae=Object(c.a)(s.a.mark((function e(t,n,r){var i,a,o,l,c,u,f,h,d,v,y;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=new B(n.seed),a=t.tiles.filter((function(e){return e.region===n})),o=a.filter((function(e){return 8===e.adjacentTiles.length&&!e.adjacentTiles.some((function(e){return e.region!==n}))})),l=o.filter((function(e){return!e.isFloor})),c=!0,u=!1,f=void 0,e.prev=7,h=o[Symbol.iterator]();!(c=(d=h.next()).done);c=!0)v=d.value,i.next()<.5&&(v.isFloor=!0);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),u=!0,f=e.t0;case 15:e.prev=15,e.prev=16,c||null==h.return||h.return();case 18:if(e.prev=18,!u){e.next=21;break}throw f;case 21:return e.finish(18);case 22:return e.finish(15);case 23:y=0;case 24:if(!(y<8)){e.next=32;break}if(oe(l),!r){e.next=29;break}return e.next=29,r(Be.Small);case 29:y++,e.next=24;break;case 32:se(t,n,o);case 33:case"end":return e.stop()}}),e,null,[[7,11,15,23],[16,,18,22]])})))).apply(this,arguments)}function oe(e){var t=new Map,n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,l=s.isFloor,c=s.adjacentTiles.filter((function(e){return e.isFloor})).length,f=l?c>=4:c>4;t.set(s,f)}}catch(k){r=!0,i=k}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var h=!0,d=!1,v=void 0;try{for(var y,p=t[Symbol.iterator]();!(h=(y=p.next()).done);h=!0){var b=y.value,g=Object(u.a)(b,2),m=g[0],x=g[1];m.isFloor=x}}catch(k){d=!0,v=k}finally{try{h||null==p.return||p.return()}finally{if(d)throw v}}}function se(e,t,n){for(var r=e.tilesByCoordinates[Math.floor(t.x)][Math.floor(t.y)],i=new Set([r]),a=Object(re.a)(r.adjacentTiles);;){var o=a.pop();if(void 0===o)break;o.isFloor&&o.region===t&&!i.has(o)&&(i.add(o),a=[].concat(Object(re.a)(a),Object(re.a)(o.adjacentTiles)))}var s=!0,l=!1,c=void 0;try{for(var u,f=n[Symbol.iterator]();!(s=(u=f.next()).done);s=!0){var h=u.value;h.isFloor&&!i.has(h)&&(h.isFloor=!1)}}catch(d){l=!0,c=d}finally{try{s||null==f.return||f.return()}finally{if(l)throw c}}}function le(e,t,n){return ce.apply(this,arguments)}function ce(){return(ce=Object(c.a)(s.a.mark((function e(t,n,r){var i,a,o,l,c,u,f,h,d,v,y;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=new B(n.seed),a=Math.floor(n.x),o=Math.floor(n.y),l=ue(t,n,a,o,i),c=l.minX,u=l.minY,f=l.maxX,h=l.maxY,d=c;case 5:if(!(d<=f)){e.next=19;break}v=u;case 7:if(!(v<=h)){e.next=16;break}if((y=t.tilesByCoordinates[d][v]).region===n){e.next=11;break}return e.abrupt("continue",13);case 11:y.isFloor=!0,y.region=n;case 13:v++,e.next=7;break;case 16:d++,e.next=5;break;case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e,t,n,r,i){var a=n,o=n,s=r,l=r;if(i.next()<.5){var c=fe(e,t,i,a,s,o,l),f=Object(u.a)(c,2),h=he(e,t,i,a=f[0],s=f[1],o,l),d=Object(u.a)(h,2);o=d[0],l=d[1]}else{var v=he(e,t,i,a,s,o,l),y=Object(u.a)(v,2),p=fe(e,t,i,a,s,o=y[0],l=y[1]),b=Object(u.a)(p,2);a=b[0],s=b[1]}return i.next()<.75&&(a=i.nextIntInRange(a,n),o=i.nextIntInRange(n+1,o+1),s=i.nextIntInRange(s,r),l=i.nextIntInRange(r+1,l+1)),{minX:a,minY:s,maxX:o,maxY:l}}function fe(e,t,n,r,i,a,o){for(var s=!0,l=!0;s||l;)l&&n.next()<.5?l=ve(e,t,i-1,r,a)&&--i>2:s&&(s=de(e,t,r-1,i,o)&&--r>2);return[r,i]}function he(e,t,n,r,i,a,o){for(var s=!0,l=!0;s||l;)l&&n.next()<.5?l=ve(e,t,o+1,r,a)&&++o<e.height-3:s&&(s=de(e,t,a+1,i,o)&&++a<e.width-3);return[a,o]}function de(e,t,n,r,i){for(var a=e.tilesByCoordinates[n],o=r;o<=i;o++)if(a[o].region!==t)return!1;return!0}function ve(e,t,n,r,i){for(var a=r;a<=i;a++)if(e.tilesByCoordinates[a][n].region!==t)return!1;return!0}function ye(e,t,n,r){return pe.apply(this,arguments)}function pe(){return(pe=Object(c.a)(s.a.mark((function e(t,n,r,i){var a,o,l,c,u,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=!0,o=!1,l=void 0,e.prev=3,c=t.nodes[Symbol.iterator]();case 5:if(a=(u=c.next()).done){e.next=23;break}f=u.value,e.t0=f.regionType,e.next=e.t0===b.Natural?10:e.t0===b.Artificial?13:16;break;case 10:return e.next=12,ie(t,f,i);case 12:return e.abrupt("break",17);case 13:return e.next=15,le(t,f,i);case 15:return e.abrupt("break",17);case 16:return e.abrupt("continue",20);case 17:if(!i){e.next=20;break}return e.next=20,i(Be.Medium);case 20:a=!0,e.next=5;break;case 23:e.next=29;break;case 25:e.prev=25,e.t1=e.catch(3),o=!0,l=e.t1;case 29:e.prev=29,e.prev=30,a||null==c.return||c.return();case 32:if(e.prev=32,!o){e.next=35;break}throw l;case 35:return e.finish(32);case 36:return e.finish(29);case 37:case"end":return e.stop()}}),e,null,[[3,25,29,37],[30,,32,36]])})))).apply(this,arguments)}function be(e,t,n,r){return ge.apply(this,arguments)}function ge(){return(ge=Object(c.a)(s.a.mark((function e(t,n,r,i){var a,o,l,c,u,f,h,d,v,y,p,b,g,m,x,k,w,S,O,j,P,C,R;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=!0,o=!1,l=void 0,e.prev=3,c=t.lines[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)for(f=u.value,h=Math.floor(f.from.x),d=Math.floor(f.to.x),v=Math.floor(f.from.y),y=Math.floor(f.to.y),void 0!==(p=t.tilesByCoordinates[h])&&void 0!==(b=p[v])&&(b.isFloor=!0),void 0!==(g=t.tilesByCoordinates[d])&&void 0!==(m=g[y])&&(m.isFloor=!0),(x=Math.abs(y-v)>Math.abs(d-h))&&(k=v,v=h,h=k,k=y,y=d,d=k),h>d&&(w=d,d=h,h=w,w=y,y=v,v=w),O=v+.5*(S=(y-v)/(d-h)),j=h;j<d;j++)P=Math.round(O-.5),C=P+.5>O?-1:1,R=Math.abs(O-P)<.1,x?(t.tilesByCoordinates[P+C][j].isFloor=!0,t.tilesByCoordinates[P][j].isFloor=!0,R||(t.tilesByCoordinates[P-C][j].isFloor=!0)):(t.tilesByCoordinates[j][P+C].isFloor=!0,t.tilesByCoordinates[j][P].isFloor=!0,R||(t.tilesByCoordinates[j][P-C].isFloor=!0)),O+=S;e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),o=!0,l=e.t0;case 11:e.prev=11,e.prev=12,a||null==c.return||c.return();case 14:if(e.prev=14,!o){e.next=17;break}throw l;case 17:return e.finish(14);case 18:return e.finish(11);case 19:case"end":return e.stop()}}),e,null,[[3,7,11,19],[12,,14,18]])})))).apply(this,arguments)}function me(e,t,n,r){return xe.apply(this,arguments)}function xe(){return(xe=Object(c.a)(s.a.mark((function e(t,n,r,i){var a,o,l,c,u,f,h,d,v,y,p,g,m,x,k,w,S,O,j,P;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0,o=!0,l=!1,c=void 0,e.prev=4,u=t.tiles[Symbol.iterator]();case 6:if(o=(f=u.next()).done){e.next=74;break}if(!(h=f.value).isFloor){e.next=10;break}return e.abrupt("continue",71);case 10:d=ke(t,h,!0,!1),v=!0,y=!1,p=void 0,e.prev=14,g=d[Symbol.iterator]();case 16:if(v=(m=g.next()).done){e.next=25;break}if(!(x=m.value).isFloor){e.next=22;break}return h.isWall=!0,h.region=x.region,e.abrupt("break",25);case 22:v=!0,e.next=16;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(14),y=!0,p=e.t0;case 31:e.prev=31,e.prev=32,v||null==g.return||g.return();case 34:if(e.prev=34,!y){e.next=37;break}throw p;case 37:return e.finish(34);case 38:return e.finish(31);case 39:k=!0,w=!1,S=void 0,e.prev=42,O=h.adjacentTiles[Symbol.iterator]();case 44:if(k=(j=O.next()).done){e.next=53;break}if(!(P=j.value).isFloor||null===P.region||P.region.regionType!==b.Artificial){e.next=50;break}return h.isWall=!0,h.region=P.region,e.abrupt("break",53);case 50:k=!0,e.next=44;break;case 53:e.next=59;break;case 55:e.prev=55,e.t1=e.catch(42),w=!0,S=e.t1;case 59:e.prev=59,e.prev=60,k||null==O.return||O.return();case 62:if(e.prev=62,!w){e.next=65;break}throw S;case 65:return e.finish(62);case 66:return e.finish(59);case 67:if(!(i&&++a>=t.height)){e.next=71;break}return a=0,e.next=71,i(Be.Tiny);case 71:o=!0,e.next=6;break;case 74:e.next=80;break;case 76:e.prev=76,e.t2=e.catch(4),l=!0,c=e.t2;case 80:e.prev=80,e.prev=81,o||null==u.return||u.return();case 83:if(e.prev=83,!l){e.next=86;break}throw c;case 86:return e.finish(83);case 87:return e.finish(80);case 88:case"end":return e.stop()}}),e,null,[[4,76,80,88],[14,27,31,39],[32,,34,38],[42,55,59,67],[60,,62,66],[81,,83,87]])})))).apply(this,arguments)}function ke(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=[];return n&&(t.x>0&&i.push(e.tilesByCoordinates[t.x-1][t.y]),t.x<e.width-1&&i.push(e.tilesByCoordinates[t.x+1][t.y]),t.y>0&&i.push(e.tilesByCoordinates[t.x][t.y-1]),t.y<e.height-1&&i.push(e.tilesByCoordinates[t.x][t.y+1])),r&&(t.x>0&&(t.y>0&&i.push(e.tilesByCoordinates[t.x-1][t.y-1]),t.y<e.height-1&&i.push(e.tilesByCoordinates[t.x-1][t.y+1])),t.x<e.width-1&&(t.y>0&&i.push(e.tilesByCoordinates[t.x+1][t.y-1]),t.y<e.height-1&&i.push(e.tilesByCoordinates[t.x+1][t.y+1]))),i}var we=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.75;Object(m.a)(this,e),this.curvature=t,this.keyPoints=void 0,this.isLoop=void 0,this.renderPoints=void 0,this.keyPoints=[],this.isLoop=!1,this.renderPoints=[]}return Object(S.a)(e,[{key:"updateRenderPoints",value:function(){if(this.renderPoints=[],!(this.keyPoints.length<2)){var t,n,r,i,a,o,s,l,c,u,f,h,d,v,y=this.curvature,p=[],b=this.keyPoints[0],g=this.keyPoints[this.keyPoints.length-1];b===g?(v=this.keyPoints.length-2,g=this.keyPoints[v]):v=this.keyPoints.length-1;var m=!0,x=!1,k=void 0;try{for(var w,S=this.keyPoints[Symbol.iterator]();!(m=(w=S.next()).done);m=!0){var O=w.value;p.push(O.x,O.y)}}catch(P){x=!0,k=P}finally{try{m||null==S.return||S.return()}finally{if(x)throw k}}if(this.isLoop){var j=this.keyPoints[1];p.push(b.x,b.y),p.push(j.x,j.y),p.unshift(g.x,g.y)}else p.unshift(b.x,b.y),p.push(g.x,g.y);for(d=2;d<p.length-4;d+=2)for(h=0;h<=e.stepsPerSegment;h++)r=(p[d+2]-p[d-2])*y,i=(p[d+4]-p[d])*y,a=(p[d+3]-p[d-1])*y,o=(p[d+5]-p[d+1])*y,f=h/e.stepsPerSegment,s=2*Math.pow(f,3)-3*Math.pow(f,2)+1,l=-2*Math.pow(f,3)+3*Math.pow(f,2),c=Math.pow(f,3)-2*Math.pow(f,2)+f,u=Math.pow(f,3)-Math.pow(f,2),t=s*p[d]+l*p[d+2]+c*r+u*i,n=s*p[d+1]+l*p[d+3]+c*a+u*o,this.renderPoints.push(t),this.renderPoints.push(n)}}}]),e}();function Se(e,t,n,r){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(c.a)(s.a.mark((function e(t,n,r,i){var a,o,l,c,u,f,h,d,v,y,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.walls=[],a=!0,o=!1,l=void 0,e.prev=4,c=t.tiles[Symbol.iterator]();case 6:if(a=(u=c.next()).done){e.next=17;break}if(!(f=u.value).isWall||f.isFloor){e.next=14;break}return e.next=11,je(t,f,!0,i);case 11:if(!i){e.next=14;break}return e.next=14,i(Be.Medium);case 14:a=!0,e.next=6;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(4),o=!0,l=e.t0;case 23:e.prev=23,e.prev=24,a||null==c.return||c.return();case 26:if(e.prev=26,!o){e.next=29;break}throw l;case 29:return e.finish(26);case 30:return e.finish(23);case 31:for(h=!0,d=!1,v=void 0,e.prev=34,y=t.walls[Symbol.iterator]();!(h=(p=y.next()).done);h=!0)p.value.updateRenderPoints();e.next=42;break;case 38:e.prev=38,e.t1=e.catch(34),d=!0,v=e.t1;case 42:e.prev=42,e.prev=43,h||null==y.return||y.return();case 45:if(e.prev=45,!d){e.next=48;break}throw v;case 48:return e.finish(45);case 49:return e.finish(42);case 50:case"end":return e.stop()}}),e,null,[[4,19,23,31],[24,,26,30],[34,38,42,50],[43,,45,49]])})))).apply(this,arguments)}function je(e,t,n,r){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(c.a)(s.a.mark((function e(t,n,r,i){var a,o,l,c,u,f;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Te(t,n,i);case 2:a=e.sent;case 3:if(void 0!==(o=Ce(t,a))){e.next=9;break}return r&&Re(t,a),void 0!==i&&a.updateRenderPoints(),e.abrupt("return",a);case 9:return l=a.keyPoints.indexOf(o),e.next=12,je(t,o,!1,i);case 12:if(!((c=e.sent).keyPoints.length<=a.keyPoints.length-l||o===n)){e.next=15;break}return e.abrupt("continue",3);case 15:if(u=c.keyPoints.slice(1),(f=a.keyPoints.splice(l+1)).unshift(o),c.keyPoints=f,a.keyPoints=a.keyPoints.concat(u),r&&Re(t,c),void 0===i){e.next=26;break}return c.updateRenderPoints(),a.updateRenderPoints(),e.next=26,i(Be.Medium);case 26:e.next=3;break;case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(e,t){for(var n=t.keyPoints.length-1;n>=0;n--){var r=t.keyPoints[n];if(void 0!==Le(e,r,!0,!0,(function(e){return!e.isFloor&&e.isWall})))return r}}function Re(e,t,n){var r=t.keyPoints[0],i=t.keyPoints[t.keyPoints.length-1];if(r===i)t.isLoop=!0;else{var a=t.keyPoints.lastIndexOf(r);if(a>0){var o=new we;o.keyPoints=t.keyPoints.splice(a+1),o.keyPoints.unshift(t.keyPoints[a]),n&&o.updateRenderPoints(),e.walls.push(o),t.isLoop=!0}if((a=t.keyPoints.indexOf(i))<t.keyPoints.length-1){var s=new we,l=t.keyPoints[a];s.keyPoints=t.keyPoints.splice(0,a-1),s.keyPoints.push(l),n&&s.updateRenderPoints(),e.walls.push(s),t.isLoop=!0}}}function Te(e,t,n){return ze.apply(this,arguments)}function ze(){return(ze=Object(c.a)(s.a.mark((function e(t,n,r){var i,a,o,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=new we,t.walls.push(i),a=n,void 0!==(o=ke(t,n,!0,!0).find((function(e){return e.isWall&&e.isFloor})))&&(i.keyPoints.push(o),n=o),i.keyPoints.push(a),a.isFloor=!0;case 7:if(void 0===(l=Me(t,a,(function(e){return!e.isFloor&&e.isWall})))?function(){var e=i.keyPoints.length>2?i.keyPoints[i.keyPoints.length-2]:void 0;l=Me(t,a,(function(t){return t.isWall&&t!==e})),a=void 0}():a=l,l!==n){e.next=12;break}return i.isLoop=!0,e.abrupt("break",23);case 12:if(void 0!==l){e.next=14;break}return e.abrupt("break",23);case 14:if(i.keyPoints.push(l),!l.isFloor){e.next=17;break}return e.abrupt("break",23);case 17:if(l.isFloor=!0,!r){e.next=22;break}return i.updateRenderPoints(),e.next=22,r(Be.Minimal);case 22:if(void 0!==a){e.next=7;break}case 23:if(!r){e.next=27;break}return i.updateRenderPoints(),e.next=27,r(Be.Medium);case 27:return e.abrupt("return",i);case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(e,t,n){var r=Le(e,t,!0,!1,n);return void 0!==r?r:Le(e,t,!1,!0,n)}function Le(e,t,n,r,i){var a,o=0,s=ke(e,t,n,r),l=!0,c=!1,u=void 0;try{for(var f,h=s[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var d=f.value;if(i(d)){var v=0,y=ke(e,d,!0,!0),p=!0,b=!1,g=void 0;try{for(var m,x=y[Symbol.iterator]();!(p=(m=x.next()).done);p=!0){m.value.isWall||v++}}catch(k){b=!0,g=k}finally{try{p||null==x.return||x.return()}finally{if(b)throw g}}v>o&&(o=v,a=d)}}}catch(k){c=!0,u=k}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}return a}function Ee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return t.distanceSqTo(e)},r=Number.MAX_VALUE,i=null,a=!0,o=!1,s=void 0;try{for(var l,c=t[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var u=l.value,f=n(u,e);f<r&&(r=f,i=u)}}catch(h){o=!0,s=h}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}return i}function Ae(e,t,n,r){return _e.apply(this,arguments)}function _e(){return(_e=Object(c.a)(s.a.mark((function e(t,n,r,i){var a,o,l,c,u,f,h,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0,o=function(e,t){return t.distanceSqTo(e)/e.regionInfluence},l=!0,c=!1,u=void 0,e.prev=5,f=t.tiles[Symbol.iterator]();case 7:if(l=(h=f.next()).done){e.next=17;break}if((d=h.value).region=Ee(d,t.nodes,o),!(i&&++a>=t.height)){e.next=14;break}return a=0,e.next=14,i(Be.Minimal);case 14:l=!0,e.next=7;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),c=!0,u=e.t0;case 23:e.prev=23,e.prev=24,l||null==f.return||f.return();case 26:if(e.prev=26,!c){e.next=29;break}throw u;case 29:return e.finish(26);case 30:return e.finish(23);case 31:case"end":return e.stop()}}),e,null,[[5,19,23,31],[24,,26,30]])})))).apply(this,arguments)}we.stepsPerSegment=16;var Fe=function(e){function t(e,n,r){var i;if(Object(m.a)(this,t),void 0===r)return(i=Object(x.a)(this,Object(k.a)(t).call(this,e+.5,n+.5))).rotation=void 0,i.lengthScale=void 0,i.topSkew=void 0,i.bottomSkew=void 0,i.rotation=0,i.lengthScale=1,i.topSkew=0,i.bottomSkew=0,Object(x.a)(i);var a=new B(r+e*e*4987142+5947611*e+n*n*4392871+389711*n);return(i=Object(x.a)(this,Object(k.a)(t).call(this,e+a.nextInRange(.1,.9),n+a.nextInRange(.1,.9)))).rotation=void 0,i.lengthScale=void 0,i.topSkew=void 0,i.bottomSkew=void 0,i.rotation=a.nextInRange(0,2*Math.PI),i.lengthScale=a.nextInRange(.9,1.35),i.topSkew=a.nextInRange(0,.25),i.bottomSkew=a.nextInRange(0,.25),Object(x.a)(i)}return Object(w.a)(t,e),t}(O);function Ne(e,t,n,r){return We.apply(this,arguments)}function We(){return(We=Object(c.a)(s.a.mark((function e(t,n,r,i){var a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.tiles.filter((function(e){return e.isWall})),o=new Set,Ie(a,o),Ie(Object(re.a)(o),o),Ie(Object(re.a)(o),o),t.backdropPoints=Object(re.a)(o).filter((function(e){return(e.x+e.y)%2!==0})).map((function(e){return new Fe(e.x,e.y,r)}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,l=!0,c=!1,u=void 0;try{for(var f,h=s.adjacentTiles[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var d=f.value;d.isFloor||t.add(d)}}catch(v){c=!0,u=v}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}}}catch(v){r=!0,i=v}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}var Be,De=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object(m.a)(this,t),(r=Object(x.a)(this,Object(k.a)(t).call(this,e,n))).isFloor=i,r.isWall=a,r.region=null,r.adjacentTiles=[],r}return Object(w.a)(t,e),t}(O);function Ge(e,t,n,r){return qe.apply(this,arguments)}function qe(){return(qe=Object(c.a)(s.a.mark((function e(t,n,r,i){var a,o,l,c,u,f,h,d,v;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t.tiles=[],t.tilesByCoordinates=[],a=0;a<t.width;a++)for(o=new Array(t.height),t.tilesByCoordinates[a]=o,l=0;l<t.height;l++)c=new De(a,l),o[l]=c,t.tiles.push(c);for(u=t.width-1,f=t.height-1,h=0;h<t.width;h++)for(d=0;d<t.height;d++)v=t.tilesByCoordinates[h][d],h>0&&(d>0&&v.adjacentTiles.push(t.tilesByCoordinates[h-1][d-1]),v.adjacentTiles.push(t.tilesByCoordinates[h-1][d]),d<f&&v.adjacentTiles.push(t.tilesByCoordinates[h-1][d+1])),d>0&&v.adjacentTiles.push(t.tilesByCoordinates[h][d-1]),d<f&&v.adjacentTiles.push(t.tilesByCoordinates[h][d+1]),h<u&&(d>0&&v.adjacentTiles.push(t.tilesByCoordinates[h+1][d-1]),v.adjacentTiles.push(t.tilesByCoordinates[h+1][d]),d<f&&v.adjacentTiles.push(t.tilesByCoordinates[h+1][d+1]));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ue(e){return Xe.apply(this,arguments)}function Xe(){return(Xe=Object(c.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new E,e.next=3,Ve(n,t);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ve(e,t){return Ye.apply(this,arguments)}function Ye(){return(Ye=Object(c.a)(s.a.mark((function e(t,n){var i,a,o,l,f,h,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.width=n.cellsWide,t.height=n.cellsHigh,i=new B(n.seed),a=[[r.CreateTiles,Ge,Be.None],[r.CreateNodes,D,Be.Large],[r.AssociateTiles,Ae,Be.Large],[r.LinkNodes,Z,Be.Large],[r.FilterLinks,te,Be.Large],[r.ExpandLines,be,Be.Large],[r.CreateRooms,ye,Be.Large],[r.DetectWalls,me,Be.Large],[r.CurveWalls,Se,Be.Large],[r.FillBackdrop,Ne,Be.Large]],o=s.a.mark((function e(){var r,a,o,d,v,y;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f[l],h=Object(u.a)(r,3),a=h[0],o=h[1],d=h[2],v=i.next(),!(n.generateFrom>a)){e.next=8;break}return e.abrupt("return","continue");case 8:if(!(n.generateTo<a)){e.next=10;break}return e.abrupt("return","break");case 10:return y=n.animateFrom<=a?function(){var e=Object(c.a)(s.a.mark((function e(r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.animateFrom>a)){e.next=2;break}return e.abrupt("return");case 2:return n.redraw(t,a,!1),e.next=5,He(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}():void 0,e.next=13,o(t,n,v,y);case 13:if(!(n.animateFrom<=a&&d>Be.None)){e.next=17;break}return n.redraw(t,a,!0),e.next=17,He(d);case 17:case"end":return e.stop()}}),e)})),l=0,f=a;case 6:if(!(l<f.length)){e.next=17;break}return e.delegateYield(o(),"t0",8);case 8:d=e.t0,e.t1=d,e.next="continue"===e.t1?12:"break"===e.t1?13:14;break;case 12:return e.abrupt("continue",14);case 13:return e.abrupt("break",17);case 14:l++,e.next=6;break;case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function He(e){return new Promise((function(t){setTimeout((function(){return t()}),e)}))}function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(n,!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.None=0]="None",e[e.Minimal=10]="Minimal",e[e.Tiny=50]="Tiny",e[e.Small=100]="Small",e[e.Medium=500]="Medium",e[e.Large=1500]="Large"}(Be||(Be={}));var Ke=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Qe(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(22);a.render(i.createElement((function(){var e=i.useRef(null),t=Object(i.useState)(new E),n=Object(u.a)(t,2),a=n[0],o=n[1],l=Object(i.useState)(!1),h=Object(u.a)(l,2),d=h[0],v=h[1],y=Object(i.useState)(f(r.Render,!0,10)),p=Object(u.a)(y,2),b=p[0],g=p[1],m=Object(i.useState)({seed:0,generateFrom:r.FIRST_STEP,generateTo:r.Render,animateFrom:r.Render,cellsWide:100,cellsHigh:70,nodeCount:25,connectivity:50,redraw:function(t,n,r){null!==e.current&&A(t,e.current.ctx,f(n,r,10))}}),x=Object(u.a)(m,2),k=x[0],w=x[1],S=function(){var t=Object(c.a)(s.a.mark((function t(n){var i,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=$e({},k,{seed:Math.random(),animateFrom:r.Render,generateFrom:r.FIRST_STEP,generateTo:n}),w(i),v(!0),t.next=5,Ue(i);case 5:a=t.sent,o(a),v(!1),null!==e.current&&A(a,e.current.ctx,b);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=function(){var t=Object(c.a)(s.a.mark((function t(n,i,o){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i===r.FIRST_STEP){t.next=3;break}return t.next=3,Ve(a,$e({},k,{animateFrom:r.Render,generateFrom:r.CreateTiles,generateTo:r.CreateTiles}));case 3:return v(!0),t.next=6,Ve(a,$e({},k,{animateFrom:n?i:r.Render,generateFrom:i,generateTo:o}));case 6:v(!1),null!==e.current&&A(a,e.current.ctx,b);case 8:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}();Object(i.useEffect)((function(){S(r.Render)}),[]);return i.createElement("div",{className:"App"},i.createElement(M,{dungeon:a,canvas:null===e.current?void 0:e.current.canvas,cellSize:10,isGenerating:d,generationSettings:k,setGenerationSettings:w,setRenderSettings:function(t){g(t),null!==e.current&&A(a,e.current.ctx,t)},generate:S,regenerate:O,skip:function(){return k.animateFrom++},finish:function(){return k.animateFrom=r.Render}}),i.createElement(L,{className:"dungeonDisplay",width:10*k.cellsWide,height:10*k.cellsHigh,ref:e}))}),null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");Ke?function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Qe(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):Qe(e)}))}}()}},[[14,1,2]]]);
//# sourceMappingURL=main.2ad8c172.chunk.js.map